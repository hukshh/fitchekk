import{j as e,r,C as D,z as l,q as P,s as $,t as I,p as Q,v as T,w as W,o as Y}from"./index-DAsNgVti.js";import{u as J}from"./useApi-ex_VrPEw.js";import{B as O}from"./Button-CcPpVbSf.js";const K=({product:t,onAddToCart:c})=>{var d;return e.jsxs("div",{className:"card group overflow-hidden",children:[e.jsxs("div",{className:"relative h-48 -mx-6 -mt-6 mb-4 overflow-hidden bg-dark-surface",children:[t.imageUrl?e.jsx("img",{src:t.imageUrl,alt:t.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-text-muted",children:e.jsx("svg",{className:"w-12 h-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),t.category&&e.jsx("span",{className:"absolute top-3 left-3 px-2.5 py-1 bg-primary/90 text-white text-xs font-medium rounded-full",children:t.category.name})]}),e.jsx("h3",{className:"font-semibold text-text-primary mb-1 line-clamp-1",children:t.name}),e.jsx("p",{className:"text-sm text-text-muted mb-3 line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between mt-auto",children:[e.jsxs("span",{className:"text-lg font-bold text-primary",children:["$",(d=t.price)==null?void 0:d.toFixed(2)]}),e.jsx("button",{onClick:()=>c==null?void 0:c(t.id),className:"btn-primary !py-2 !px-4 !text-sm",children:"Add to Cart"})]})]})},ee=()=>{const{get:t,post:c,put:d,del:A}=J(),{items:j,total:i,count:p,setCart:g}=r.useContext(D),[y,F]=r.useState([]),[H,U]=r.useState([]),[q,z]=r.useState(!0),[o,E]=r.useState(""),[n,N]=r.useState(""),[L,m]=r.useState(!1),[M,f]=r.useState(!1),[x,v]=r.useState(""),[B,w]=r.useState(!1),b=r.useCallback(async()=>{try{const s=new URLSearchParams;o&&s.set("search",o),n&&s.set("category",n);const a=await t(`/products?${s}`);F(a.products||[])}catch(s){l.error(s.message)}},[t,o,n]),u=r.useCallback(async()=>{try{const s=await t("/cart");g(s)}catch(s){console.error(s)}},[t,g]),G=r.useCallback(async()=>{try{const s=await t("/products/categories");U(s.categories||[])}catch(s){console.error(s)}},[t]);r.useEffect(()=>{Promise.all([b(),u(),G()]).finally(()=>z(!1))},[]),r.useEffect(()=>{const s=setTimeout(()=>{b()},300);return()=>clearTimeout(s)},[o,n,b]);const R=async s=>{try{await c("/cart",{productId:s}),l.success("Added to cart!"),u()}catch(a){l.error(a.message)}},k=async(s,a)=>{try{a<1?await A(`/cart/${s}`):await d(`/cart/${s}`,{quantity:a}),u()}catch(h){l.error(h.message)}},X=async()=>{if(!x.trim()||x.length<5){l.error("Enter a valid shipping address");return}w(!0);try{await c("/orders",{shippingAddress:x}),l.success("Order placed successfully! ðŸŽ‰"),f(!1),m(!1),v(""),u()}catch(s){l.error(s.message)}finally{w(!1)}};return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Store"}),e.jsx("p",{className:"text-text-muted mt-1",children:"Premium fitness gear & supplements"})]}),e.jsxs("button",{onClick:()=>m(!0),className:"relative p-3 bg-dark-card border border-dark-border rounded-xl hover:border-primary transition-colors",children:[e.jsx(P,{className:"w-5 h-5"}),p>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-primary text-white text-xs font-bold rounded-full flex items-center justify-center",children:p})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-8",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx($,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-text-muted"}),e.jsx("input",{type:"text",placeholder:"Search products...",className:"w-full pl-12 pr-4 py-3 bg-dark-card border border-dark-border rounded-xl text-text-primary placeholder-text-muted focus:outline-none focus:border-primary transition-all",value:o,onChange:s=>E(s.target.value)})]}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-1",children:[e.jsx("button",{onClick:()=>N(""),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all ${n?"bg-dark-card text-text-secondary border border-dark-border hover:border-primary":"bg-primary text-white"}`,children:"All"}),H.map(s=>e.jsx("button",{onClick:()=>N(s.name),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all ${n===s.name?"bg-primary text-white":"bg-dark-card text-text-secondary border border-dark-border hover:border-primary"}`,children:s.name},s.id))]})]}),q?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[1,2,3,4].map(s=>e.jsx(I,{},s))}):y.length===0?e.jsxs("div",{className:"card text-center py-16",children:[e.jsx($,{className:"w-16 h-16 text-text-muted mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No products found"}),e.jsx("p",{className:"text-text-muted",children:"Try adjusting your search or filters"})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:y.map(s=>e.jsx(K,{product:s,onAddToCart:R},s.id))}),L&&e.jsxs("div",{className:"fixed inset-0 z-50 flex justify-end",onClick:()=>m(!1),children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),e.jsx("div",{className:"relative w-full max-w-md bg-dark-card border-l border-dark-border h-full overflow-y-auto animate-slide-right",style:{animationDirection:"reverse",animationName:"none",transform:"translateX(0)"},onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold",children:["Cart (",p,")"]}),e.jsx("button",{onClick:()=>m(!1),className:"p-1 text-text-muted hover:text-text-primary",children:e.jsx(Q,{className:"w-6 h-6"})})]}),j.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(P,{className:"w-12 h-12 text-text-muted mx-auto mb-4"}),e.jsx("p",{className:"text-text-muted",children:"Your cart is empty"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4 mb-6",children:j.map(s=>{var a,h,C,S;return e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-dark-surface rounded-xl",children:[e.jsx("div",{className:"w-16 h-16 rounded-lg bg-dark-card overflow-hidden flex-shrink-0",children:(a=s.product)!=null&&a.imageUrl?e.jsx("img",{src:s.product.imageUrl,alt:s.product.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-text-muted text-xs",children:"IMG"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:(h=s.product)==null?void 0:h.name}),e.jsxs("p",{className:"text-sm text-primary font-semibold",children:["$",(S=(C=s.product)==null?void 0:C.price)==null?void 0:S.toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>k(s.id,s.quantity-1),className:"w-7 h-7 rounded-lg bg-dark-card flex items-center justify-center text-text-muted hover:text-primary transition-colors",children:s.quantity===1?e.jsx(T,{className:"w-3.5 h-3.5"}):e.jsx(W,{className:"w-3.5 h-3.5"})}),e.jsx("span",{className:"w-6 text-center text-sm font-medium",children:s.quantity}),e.jsx("button",{onClick:()=>k(s.id,s.quantity+1),className:"w-7 h-7 rounded-lg bg-dark-card flex items-center justify-center text-text-muted hover:text-primary transition-colors",children:e.jsx(Y,{className:"w-3.5 h-3.5"})})]})]},s.id)})}),e.jsxs("div",{className:"border-t border-dark-border pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"text-text-secondary",children:"Total"}),e.jsxs("span",{className:"text-2xl font-bold",children:["$",i==null?void 0:i.toFixed(2)]})]}),e.jsx(O,{onClick:()=>{f(!0)},className:"w-full justify-center",children:"Checkout"})]})]})]})})]}),M&&e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm px-4",onClick:()=>f(!1),children:e.jsxs("div",{className:"glass-strong rounded-3xl p-6 sm:p-8 w-full max-w-md",onClick:s=>s.stopPropagation(),children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Checkout"}),e.jsx("p",{className:"text-sm text-text-muted mb-1",children:"Order Total"}),e.jsxs("p",{className:"text-3xl font-bold text-primary mb-6",children:["$",i==null?void 0:i.toFixed(2)]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1.5",children:"Shipping Address"}),e.jsx("textarea",{className:"w-full px-4 py-3 bg-dark-surface border border-dark-border rounded-xl text-text-primary placeholder-text-muted focus:outline-none focus:border-primary transition-all resize-none",rows:3,placeholder:"123 Fitness St, Gym City, GC 12345",value:x,onChange:s=>v(s.target.value)})]}),e.jsx(O,{onClick:X,loading:B,className:"w-full justify-center",children:"Place Order"})]})})]})};export{ee as default};
