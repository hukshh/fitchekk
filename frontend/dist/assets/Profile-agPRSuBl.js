import{u as L,r,z as i,j as e,S as U,d as B,i as O,k as z,g as v}from"./index-DAsNgVti.js";import{u as F}from"./useApi-ex_VrPEw.js";import{I as w}from"./Input-CmxOoK9T.js";import{B as S}from"./Button-CcPpVbSf.js";const T=()=>{var j,g,N,b;const{user:R,updateUser:_}=L(),{get:c,put:k}=F(),[s,m]=r.useState(null),[o,C]=r.useState([]),[P,A]=r.useState(!0),[n,u]=r.useState(!1),[l,x]=r.useState({user_name:"",user_email:""}),[D,h]=r.useState(!1),p=r.useCallback(async()=>{try{const[t,a]=await Promise.all([c("/users/profile"),c("/orders")]);m(t.user),C(a.orders||[]),x({user_name:t.user.user_name,user_email:t.user.user_email})}catch(t){i.error(t.message)}finally{A(!1)}},[c]);r.useEffect(()=>{p()},[p]);const E=async t=>{t.preventDefault(),h(!0);try{const a=await k("/users/profile",l);_(a.user),m({...s,...a.user}),u(!1),i.success("Profile updated!")}catch(a){i.error(a.message)}finally{h(!1)}},H={pending:"bg-yellow-400/10 text-yellow-400",processing:"bg-blue-400/10 text-blue-400",shipped:"bg-cyan-400/10 text-cyan-400",delivered:"bg-green-400/10 text-green-400",cancelled:"bg-red-400/10 text-red-400"};return P?e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8",children:e.jsx("div",{className:"card",children:e.jsx(U,{lines:5})})}):e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"card !p-8 mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-6",children:[e.jsx("div",{className:"w-20 h-20 rounded-2xl bg-gradient-to-br from-primary to-secondary flex items-center justify-center text-white text-2xl font-black",children:((g=(j=s==null?void 0:s.user_name)==null?void 0:j.charAt(0))==null?void 0:g.toUpperCase())||"U"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl font-bold",children:s==null?void 0:s.user_name}),e.jsx("p",{className:"text-text-muted",children:s==null?void 0:s.user_email}),e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["Member since ",new Date(s==null?void 0:s.createdAt).toLocaleDateString("en-US",{month:"long",year:"numeric"})]})]}),e.jsx(S,{variant:"secondary",className:"!py-2 !px-5 !text-sm",onClick:()=>u(!n),children:n?"Cancel":"Edit Profile"})]}),n&&e.jsxs("form",{onSubmit:E,className:"mt-6 pt-6 border-t border-dark-border space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(w,{label:"Name",value:l.user_name,onChange:t=>x({...l,user_name:t.target.value})}),e.jsx(w,{label:"Email",type:"email",value:l.user_email,onChange:t=>x({...l,user_email:t.target.value})})]}),e.jsx(S,{type:"submit",loading:D,className:"!py-2.5",children:"Save Changes"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"card text-center",children:[e.jsx(B,{className:"w-6 h-6 text-primary mx-auto mb-2"}),e.jsx("p",{className:"text-2xl font-bold",children:(s==null?void 0:s.xp)||0}),e.jsx("p",{className:"text-xs text-text-muted",children:"Total XP"})]}),e.jsxs("div",{className:"card text-center",children:[e.jsx(O,{className:"w-6 h-6 text-orange-400 mx-auto mb-2"}),e.jsx("p",{className:"text-2xl font-bold",children:(s==null?void 0:s.streak)||0}),e.jsx("p",{className:"text-xs text-text-muted",children:"Day Streak"})]}),e.jsxs("div",{className:"card text-center",children:[e.jsx(z,{className:"w-6 h-6 text-secondary mx-auto mb-2"}),e.jsx("p",{className:"text-2xl font-bold",children:((N=s==null?void 0:s._count)==null?void 0:N.workouts)||0}),e.jsx("p",{className:"text-xs text-text-muted",children:"Workouts"})]}),e.jsxs("div",{className:"card text-center",children:[e.jsx(v,{className:"w-6 h-6 text-accent mx-auto mb-2"}),e.jsx("p",{className:"text-2xl font-bold",children:((b=s==null?void 0:s._count)==null?void 0:b.orders)||0}),e.jsx("p",{className:"text-xs text-text-muted",children:"Orders"})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Order History"}),o.length===0?e.jsxs("div",{className:"card text-center py-10",children:[e.jsx(v,{className:"w-12 h-12 text-text-muted mx-auto mb-3"}),e.jsx("p",{className:"text-text-muted",children:"No orders yet"})]}):e.jsx("div",{className:"space-y-3",children:o.map(t=>{var a,f;return e.jsxs("div",{className:"card !p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-sm",children:["Order #",t.id]}),e.jsx("p",{className:"text-xs text-text-muted",children:new Date(t.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-medium capitalize ${H[t.status]||""}`,children:t.status}),e.jsxs("span",{className:"font-bold",children:["$",(a=t.totalAmount)==null?void 0:a.toFixed(2)]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:(f=t.items)==null?void 0:f.map(d=>{var y;return e.jsxs("span",{className:"text-xs bg-dark-surface px-3 py-1.5 rounded-lg text-text-secondary",children:[(y=d.product)==null?void 0:y.name," Ã—",d.quantity]},d.id)})})]},t.id)})})]})]})};export{T as default};
